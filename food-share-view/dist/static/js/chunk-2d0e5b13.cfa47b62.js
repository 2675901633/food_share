(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e5b13"],{9622:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",{staticStyle:{"background-color":"#FFFFFF",padding:"10px 0","border-radius":"5px"}},[a("el-row",{staticStyle:{padding:"10px",margin:"0 10px"}},[a("el-row",[a("el-date-picker",{staticStyle:{width:"220px"},attrs:{size:"small",type:"daterange","range-separator":"至","start-placeholder":"评论开始","end-placeholder":"评论结束"},model:{value:t.searchTime,callback:function(e){t.searchTime=e},expression:"searchTime"}}),a("el-input",{staticStyle:{width:"188px","margin-left":"5px","margin-right":"6px"},attrs:{size:"small",placeholder:"评论内容",clearable:""},on:{clear:t.handleFilterClear},model:{value:t.evalustionsQueryDto.content,callback:function(e){t.$set(t.evalustionsQueryDto,"content",e)},expression:"evalustionsQueryDto.content"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.handleFilter},slot:"append"})],1)],1)],1),a("el-row",{staticStyle:{margin:"0 20px","border-top":"1px solid rgb(245,245,245)"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[a("el-table-column",{attrs:{prop:"content",label:"文本"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.row.content,placement:"bottom"}},[a("div",{staticClass:"cell-name"},[t._v(t._s(e.row.content))])])]}}])}),a("el-table-column",{attrs:{prop:"upvoteList",width:"60",label:"点赞"},scopedSlots:t._u([{key:"default",fn:function(e){return[null!==e.row.upvoteList?a("span",{staticStyle:{"font-size":"16px","font-weight":"bolder"}},[t._v(t._s(e.row.upvoteList.split(",").length))]):a("span",{staticStyle:{"font-size":"16px","font-weight":"bolder"}},[t._v("0")])]}}])}),a("el-table-column",{attrs:{prop:"contentType",width:"100",label:"挂载源"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.contentType))])]}}])}),a("el-table-column",{attrs:{prop:"userName",width:"140",label:"评论者"}}),a("el-table-column",{attrs:{prop:"replierName",width:"140",label:"被评论"}}),a("el-table-column",{attrs:{prop:"createTime",sortable:!0,width:"168",label:"评论时间"}}),a("el-table-column",{attrs:{prop:"parentId",width:"120",label:"层级"},scopedSlots:t._u([{key:"default",fn:function(e){return[null===e.row.parentId?a("i",{staticClass:"el-icon-warning",staticStyle:{"margin-right":"5px"}}):a("i",{staticClass:"el-icon-success",staticStyle:{"margin-right":"5px",color:"rgb(253, 199, 50)"}}),null===e.row.parentId?a("span",{staticStyle:{"text-decoration":"underline","text-decoration-style":"dashed"}},[t._v("父级")]):a("span",[t._v("子级")])]}}])}),a("el-table-column",{attrs:{label:"数据操作",width:"100px",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"text-button",on:{click:function(a){return t.handleDelete(e.row)}}},[t._v("删除")])]}}])})],1),a("el-pagination",{staticStyle:{margin:"10px 0"},attrs:{"current-page":t.currentPage,"page-sizes":[20,50],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.totalItems},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)},i=[],r={data(){return{filterText:"",tableData:[],currentPage:1,pageSize:20,totalItems:0,searchTime:[],delectedRows:[],evalustionsQueryDto:{}}},created(){this.fetchFreshData()},methods:{async batchDelete(){if(!this.delectedRows.length)return void this.$message("未选中任何数据");const t=await this.$swalConfirm({title:"删除评论数据",text:"删除后不可恢复，是否继续？",icon:"warning"});if(t)try{let t=this.delectedRows.map(t=>t.id);const e=await this.$axios.post("/evaluations/batchDelete",t);if(200===e.data.code)return this.$notify({duration:1e3,title:"信息删除",message:"删除成功",type:"success"}),void this.fetchFreshData()}catch(e){console.error("评论信息删除异常：",e)}},resetQueryCondition(){this.filterText="",this.searchTime="",this.fetchFreshData()},async updateOperation(){try{const t=await this.$axios.put("/evaluations/update",this.data);this.$message[200===t.data.code?"success":"error"](t.data.msg),200===t.data.code&&(this.closeDialog(),this.fetchFreshData(),this.clearFormData())}catch(t){console.error("提交表单时出错:",t),this.$message.error("提交失败，请稍后再试！")}},async addOperation(){this.data.tag=this.dynamicTags.join(",");try{const t=await this.$axios.post("/evaluations/save",this.data);this.$message[200===t.data.code?"success":"error"](t.data.msg),200===t.data.code&&(this.closeDialog(),this.fetchFreshData(),this.clearFormData())}catch(t){console.error("提交表单时出错:",t),this.$message.error("提交失败，请稍后再试！")}},async fetchFreshData(){try{let t="",e="";if(null!==this.searchTime&&2===this.searchTime.length){const[a,s]=await Promise.all(this.searchTime.map(t=>t.toISOString()));t=a.split("T")[0]+"T00:00:00",e=s.split("T")[0]+"T23:59:59"}const a={current:this.currentPage,size:this.pageSize,startTime:t,endTime:e,...this.evalustionsQueryDto};let s=await this.$axios.post("/evaluations/query",a);const{data:i}=s;this.tableData=i.data,this.totalItems=i.total}catch(t){console.error("查询异常:",t)}},handleFilter(){this.currentPage=1,this.fetchFreshData()},handleSizeChange(t){this.pageSize=t,this.currentPage=1,this.fetchFreshData()},handleCurrentChange(t){this.currentPage=t,this.fetchFreshData()},async handleDelete(t){this.delectedRows.push(t),this.batchDelete()},handleFilterClear(){this.evalustionsQueryDto.content="",this.fetchFreshData()}}},l=r,n=a("2877"),o=Object(n["a"])(l,s,i,!1,null,"5c484d90",null);e["default"]=o.exports}}]);
//# sourceMappingURL=chunk-2d0e5b13.cfa47b62.js.map