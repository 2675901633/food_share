(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-070bd3b0"],{"02b1":function(t,e,a){"use strict";a("a581")},2241:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"logo"},[a("el-image",{staticStyle:{width:"35px",height:"35px"},attrs:{src:"/logo.png",fit:"fill"}}),t.flag?t._e():a("div",[a("span",{style:{color:t.bag,display:"block"}},[t._v(t._s(t.sysName))])])],1)},i=[],n={name:"Logo",data(){return{}},props:{sysName:{type:String,required:!0,default:"一路旅友"},flag:{type:Boolean,required:!1},bag:{type:String,default:"#1c1c1c"}},created(){},methods:{}},o=n,r=(a("02b1"),a("2877")),l=Object(r["a"])(o,s,i,!1,null,"13bf7339",null);e["a"]=l.exports},"3c19":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"menu-container"},[a("div",{staticClass:"menu-side",class:{"menu-side-narrow":t.flag}},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("Logo",{staticStyle:{padding:"0 40px",margin:"10px 0"},attrs:{sysName:"美食后台",flag:t.flag,bag:t.colorLogo}})],1),a("div",{staticStyle:{"margin-top":"12px"}},[a("AdminMenu",{attrs:{flag:t.flag,routes:t.adminRoutes,bag:t.bagMenu},on:{select:t.handleRouteSelect}})],1)]),a("div",{staticClass:"main"},[a("div",{staticClass:"header-section"},[a("LevelHeader",{attrs:{tag:t.tag,userInfo:t.userInfo},on:{eventListener:t.eventListener,selectOperation:t.selectOperation}})],1),a("div",{staticClass:"content-section"},[a("router-view")],1)]),a("el-dialog",{attrs:{"show-close":!1,visible:t.dialogOperaion,width:"20%"},on:{"update:visible":function(e){t.dialogOperaion=e}}},[a("el-row",{staticStyle:{padding:"10px 20px 20px 20px"}},[a("el-row",[a("p",{staticStyle:{"font-size":"12px",padding:"3px 0","margin-bottom":"10px"}},[a("span",{staticClass:"modelName"},[t._v("*头像")])]),a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://localhost:21090/api/food-share-sys/v1.0/file/upload","show-file-list":!1,"on-success":t.handleAvatarSuccess}},[t.userInfo.url?a("img",{staticStyle:{width:"80px",height:"80px"},attrs:{src:t.userInfo.url}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-row",[a("p",{staticStyle:{"font-size":"12px",padding:"3px 0"}},[a("span",{staticClass:"modelName"},[t._v("*用户名")])]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.userInfo.name,expression:"userInfo.name"}],staticClass:"input-title",attrs:{placeholder:"用户名"},domProps:{value:t.userInfo.name},on:{input:function(e){e.target.composing||t.$set(t.userInfo,"name",e.target.value)}}})]),a("el-row",[a("p",{staticStyle:{"font-size":"12px",padding:"3px 0"}},[a("span",{staticClass:"modelName"},[t._v("*用户邮箱")])]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.userInfo.email,expression:"userInfo.email"}],staticClass:"input-title",attrs:{placeholder:"用户邮箱"},domProps:{value:t.userInfo.email},on:{input:function(e){e.target.composing||t.$set(t.userInfo,"email",e.target.value)}}})])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("span",{staticClass:"channel-button",on:{click:function(e){t.dialogOperaion=!1}}},[t._v(" 取消操作 ")]),a("span",{staticClass:"edit-button",on:{click:function(e){return t.updateUserInfo()}}},[t._v(" 确定修改 ")])])],1)],1)},i=[],n=a("b775"),o=a("a18c"),r=a("5d2d"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-menu",{staticStyle:{padding:"5px 20px","max-width":"253px"},attrs:{"collapse-transition":!1,collapse:t.flag,"default-active":t.activeIndex,"background-color":t.bag,"text-color":"#666"},on:{select:t.handleSelect}},t._l(t.routes,(function(e,s){return e.children&&0!==e.children.length?t._e():a("el-menu-item",{key:s,class:{"is-active":t.activeIndex===e.path},staticStyle:{width:"100%"},attrs:{index:e.path}},[a("i",{class:e.icon,staticStyle:{"font-size":"20px"}}),a("span",{staticStyle:{"font-size":"14px"},attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.name))])])})),1)},c=[],u={name:"AdminMenu",data(){return{activeIndex:"1",isCollapse:!0,selectedMenuItem:""}},props:{routes:{type:Array,required:!0},flag:{type:Boolean,required:!0},bag:{type:String,default:"#FFFFFF"}},created(){const t=sessionStorage.getItem("activeMenuItem");null===t?this.handleSelect("/adminLayout"):this.handleSelect(t)},methods:{handleSelect(t){this.activeIndex=t,this.$emit("select",this.activeIndex),sessionStorage.setItem("activeMenuItem",this.activeIndex)}}},d=u,p=(a("7af9"),a("2877")),m=Object(p["a"])(d,l,c,!1,null,"13309506",null),g=m.exports,h=a("2241"),f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main"},[a("span",[a("span",{staticClass:"operation-span",on:{click:t.operation}},[t.showFlag?a("i",{staticClass:"el-icon-s-unfold i-folder"}):a("i",{staticClass:"el-icon-s-fold i-folder"})])]),a("span",[a("span",{staticClass:"operation-span-tag"},[t._v(" 后台  /  "+t._s(""==t.tag?"元数据":t.tag)+" ")])]),a("span",{staticClass:"user-block"},[a("el-dropdown",{staticClass:"user-dropdown"},[a("span",{staticClass:"el-dropdown-link",staticStyle:{display:"flex","align-items":"center"}},[a("el-avatar",{staticStyle:{"margin-top":"0"},attrs:{size:35,src:t.userInfo.url}}),a("span",{staticClass:"userName",staticStyle:{"margin-left":"5px","font-size":"16px"}},[t._v(t._s(t.userInfo.name))]),a("i",{staticClass:"el-icon-arrow-down el-icon--right",staticStyle:{"margin-left":"5px"}})],1),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{icon:"el-icon-user-solid"},nativeOn:{click:function(e){return t.userCenterPanel.apply(null,arguments)}}},[t._v("个人资料")]),a("el-dropdown-item",{attrs:{icon:"el-icon-s-fold"},nativeOn:{click:function(e){return t.loginOut.apply(null,arguments)}}},[t._v("退出登录")])],1)],1)],1)])},v=[],w={name:"LevelHeader",data(){return{showFlag:"true"===sessionStorage.getItem("flag")}},props:{tag:{type:String,required:!0,default:""},userInfo:{type:Object,required:!0,default:{}},bag:{type:String,default:""}},methods:{userCenterPanel(){this.$emit("eventListener","center")},loginOut(){this.$emit("eventListener","loginOut")},operation(){this.showFlag=!this.showFlag,sessionStorage.setItem("flag",this.showFlag),this.$emit("selectOperation",this.showFlag)}}},x=w,y=(a("5c8f"),Object(p["a"])(x,f,v,!1,null,"46716926",null)),b=y.exports,I={name:"Admin",components:{Logo:h["a"],LevelHeader:b,AdminMenu:g},data(){return{adminRoutes:[{path:"/categoryManage",name:"美食类别管理"},{path:"/gourmetManage",name:"美食内容管理"},{path:"/contentNetManage",name:"内容网络管理"}],activeIndex:"",userInfo:{id:null,url:"",name:"",role:null,email:""},flag:!1,tag:"可视化",bag:"rgb(255 255 255)",colorLogo:"rgb(51,51,51)",bagMenu:"rgb(248,248,248)",dialogOperaion:!1}},created(){let t=o["a"].options.routes.filter(t=>"/admin"==t.path)[0];this.adminRoutes=t.children,this.tokenCheckLoad(),this.menuOperationHistory()},methods:{async updateUserInfo(){try{const t={userAvatar:this.userInfo.url,userName:this.userInfo.name,userEmail:this.userInfo.email},e=await this.$axios.put("/user/update",t),{data:a}=e;200===a.code&&(this.dialogOperaion=!1,this.tokenCheckLoad(),this.$swal.fire({title:"修改个人信息",text:a.msg,icon:"success",showConfirmButton:!1,timer:1e3}))}catch(t){this.dialogOperaion=!1,this.$swal.fire({title:"修改个人信息异常",text:t,icon:"error",showConfirmButton:!1,timer:2e3}),console.error("修改个人信息异常:"+t)}},handleAvatarSuccess(t,e){200===t.code?(this.$message.success("头像上传成功"),this.userInfo.url=t.data):this.$message.error("头像上传异常")},eventListener(t){"center"===t&&(this.dialogOperaion=!0),"loginOut"===t&&this.loginOut()},async loginOut(){const t=await this.$swalConfirm({title:"退出登录？",text:"推出后需重新登录？",icon:"warning"});t&&(this.$swal.fire({title:"退出登录成功",text:"1s 后返回登录页面",icon:"success",showConfirmButton:!1,timer:1e3}),setTimeout(()=>{Object(r["a"])(),this.$router.push("/login")},1e3))},menuOperationHistory(){this.flag="true"===sessionStorage.getItem("flag")},selectOperation(t){this.flag=t},handleRouteSelect(t){let e=this.adminRoutes.filter(e=>e.path==t);if(e&&e.length>0){if(this.tag=e[0].name,this.$router.currentRoute.fullPath==t)return;this.$router.push(t)}else if(console.warn("未找到匹配的路由: "+t),this.adminRoutes.length>0){const t=this.adminRoutes[0];this.tag=t.name,this.$router.push(t.path)}},async tokenCheckLoad(){try{const t=await n["a"].get("user/auth");if(400===t.data.code)return this.$message.error(t.data.msg),void this.$router.push("/login");const{id:e,userAvatar:a,userName:s,userRole:i,userEmail:r}=t.data.data;this.userInfo={id:e,url:a,name:s,role:i,email:r};const l=1===i?"/admin":"/user",c=o["a"].options.routes.find(t=>t.path===l);c?this.routers=c.children:console.warn("未找到与角色对应的路由："+l)}catch(t){console.error("获取用户认证信息时发生错误:",t),this.$message.error("认证信息加载失败，请重试！")}}}},C=I,S=(a("ed28"),Object(p["a"])(C,s,i,!1,null,"0125d76f",null));e["default"]=S.exports},"5c8f":function(t,e,a){"use strict";a("8b7c")},"77ab":function(t,e,a){},"7af9":function(t,e,a){"use strict";a("77ab")},"8add":function(t,e,a){},"8b7c":function(t,e,a){},a581:function(t,e,a){},ed28:function(t,e,a){"use strict";a("8add")}}]);
//# sourceMappingURL=chunk-070bd3b0.db55bcd0.js.map