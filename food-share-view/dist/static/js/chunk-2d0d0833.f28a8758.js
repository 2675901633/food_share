(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d0833"],{"67fb":function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",{staticStyle:{"background-color":"#FFFFFF",padding:"5px 0","border-radius":"5px"}},[a("el-row",{staticStyle:{padding:"10px","margin-left":"5px"}},[a("el-row",{staticStyle:{display:"flex","justify-content":"left",gap:"6px"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"菜系"},on:{change:t.fetchFreshData},model:{value:t.gourmetQueryDto.categoryId,callback:function(e){t.$set(t.gourmetQueryDto,"categoryId",e)},expression:"gourmetQueryDto.categoryId"}},t._l(t.categories,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1),a("el-select",{staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"审核状态"},on:{change:t.fetchFreshData},model:{value:t.gourmetQueryDto.isAudit,callback:function(e){t.$set(t.gourmetQueryDto,"isAudit",e)},expression:"gourmetQueryDto.isAudit"}},t._l(t.auditStatus,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),a("el-select",{staticStyle:{width:"100px"},attrs:{size:"small",placeholder:"公开状态"},on:{change:t.fetchFreshData},model:{value:t.gourmetQueryDto.isPublish,callback:function(e){t.$set(t.gourmetQueryDto,"isPublish",e)},expression:"gourmetQueryDto.isPublish"}},t._l(t.publishStatus,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),a("el-date-picker",{staticStyle:{width:"216px"},attrs:{size:"small",type:"daterange","range-separator":"至","start-placeholder":"发布开始","end-placeholder":"发布结束"},on:{change:t.fetchFreshData},model:{value:t.searchTime,callback:function(e){t.searchTime=e},expression:"searchTime"}}),a("el-input",{staticStyle:{width:"186px"},attrs:{size:"small",placeholder:"做法标题",clearable:""},on:{clear:t.handleFilterClear},model:{value:t.gourmetQueryDto.title,callback:function(e){t.$set(t.gourmetQueryDto,"title",e)},expression:"gourmetQueryDto.title"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.handleFilter},slot:"append"})],1)],1)],1),a("el-row",{staticStyle:{margin:"0 22px","border-top":"1px solid rgb(245,245,245)"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{stripe:!0,data:t.tableData}},[a("el-table-column",{attrs:{prop:"cover",label:"封面",width:"90"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{staticStyle:{width:"60px",height:"35px","border-radius":"5px"},attrs:{src:t.row.cover}})]}}])}),a("el-table-column",{attrs:{prop:"title",label:"帖子标题"}}),a("el-table-column",{attrs:{prop:"userId",sortable:!0,label:"用户ID",width:"98"}}),a("el-table-column",{attrs:{prop:"userName",label:"发布者",width:"118"}}),a("el-table-column",{attrs:{prop:"categoryId",sortable:!0,label:"菜系ID",width:"98"}}),a("el-table-column",{attrs:{prop:"categoryName",label:"菜系",width:"98"}}),a("el-table-column",{attrs:{prop:"createTime",sortable:!0,label:"发布时间",width:"168"}}),a("el-table-column",{attrs:{prop:"isAudit",label:"审核状态",width:"98"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.isAudit?a("i",{staticClass:"el-icon-success",staticStyle:{"margin-right":"5px",color:"rgb(253, 199, 50)"}}):a("i",{staticClass:"el-icon-warning",staticStyle:{"margin-right":"5px",color:"rgb(199,199,199)"}}),e.row.isAudit?a("span",[t._v("已审核")]):a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"未审核美食做法，不公开访问",placement:"bottom-end"}},[a("span",{staticStyle:{"text-decoration":"underline","text-decoration-style":"dashed"}},[t._v("未审核")])])]}}])}),a("el-table-column",{attrs:{prop:"isPublish",label:"公开状态",width:"98"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.isPublish?a("i",{staticClass:"el-icon-success",staticStyle:{"margin-right":"5px",color:"rgb(253, 199, 50)"}}):a("i",{staticClass:"el-icon-warning",staticStyle:{"margin-right":"5px",color:"rgb(199,199,199)"}}),e.row.isPublish?a("span",[t._v("公开")]):a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"私有内容，他人不能访问",placement:"bottom-end"}},[a("span",{staticStyle:{"text-decoration":"underline","text-decoration-style":"dashed"}},[t._v("私有")])])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.isAudit?t._e():a("span",{staticClass:"text-button",on:{click:function(a){return t.handleEdit(e.row)}}},[t._v("审核")]),a("span",{staticClass:"text-button",on:{click:function(a){return t.handleDelete(e.row)}}},[t._v("删除")])]}}])})],1),a("el-pagination",{staticStyle:{margin:"10px 0",float:"right"},attrs:{"current-page":t.currentPage,"page-sizes":[20,50],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.totalItems},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),a("el-dialog",{attrs:{"show-close":!1,visible:t.dialogGourmetOperaion,width:"18%"},on:{"update:visible":function(e){t.dialogGourmetOperaion=e}}},[a("div",{staticStyle:{padding:"50px 20px"}},[t._v(" 确定审核【"+t._s(t.data.title)+"】这篇帖子？ ")]),a("span",{staticClass:"dialog-footer",staticStyle:{"margin-top":"10px"},attrs:{slot:"footer"},slot:"footer"},[a("span",{staticClass:"channel-button",on:{click:function(e){return t.cannel()}}},[t._v(" 取消操作 ")]),a("span",{staticClass:"edit-button",on:{click:function(e){return t.auditOpetaion()}}},[t._v(" 确定审核 ")])])])],1)},s=[],i={data(){return{data:{},filterText:"",currentPage:1,pageSize:20,totalItems:0,dialogGourmetOperaion:!1,isOperation:!1,tableData:[],delectedRows:[],searchTime:[],gourmetQueryDto:{},categories:[],auditStatus:[{value:null,label:"全部"},{value:0,label:"未审核"},{value:1,label:"已审核"}],publishStatus:[{value:null,label:"全部"},{value:0,label:"私有"},{value:1,label:"公开"}]}},created(){this.fetchFreshData(),this.fetchFreshCategories()},methods:{fetchFreshCategories(){this.$axios.post("/category/query",{}).then(t=>{if(200===t.data.code){this.categories=t.data.data;const e={id:null,name:"全部"};this.categories.unshift(e)}}).catch(t=>{console.log("查询美食做法异常：",t)})},cannel(){this.data={},this.dialogGourmetOperaion=!1,this.isOperation=!1},async batchDelete(){if(!this.delectedRows.length)return void this.$message("未选中任何数据");const t=await this.$swalConfirm({title:"删除美食做法数据",text:"删除后不可恢复，是否继续？",icon:"warning"});if(t)try{let t=this.delectedRows.map(t=>t.id);const e=await this.$axios.post("/gourmet/batchDelete",t);if(200===e.data.code)return this.$notify({duration:1e3,title:"信息删除",message:"删除成功",type:"success"}),void this.fetchFreshData()}catch(e){this.$message.error("美食做法信息删除异常：",e),console.error("美食做法信息删除异常：",e)}},async auditOpetaion(){try{const t=await this.$axios.put("/gourmet/audit/"+this.data.id);200===t.data.code&&(this.$notify({duration:1e3,title:"审核",message:t.data.msg,type:"success"}),this.cannel(),this.fetchFreshData())}catch(t){console.error("信息新增出错:",t),this.$message.error("提交失败，请稍后再试！")}},async fetchFreshData(){try{this.tableData=[];let t=null,e=null;if(null!=this.searchTime&&2===this.searchTime.length){const[a,l]=await Promise.all(this.searchTime.map(t=>t.toISOString()));t=a.split("T")[0]+"T00:00:00",e=l.split("T")[0]+"T23:59:59"}const a={current:this.currentPage,size:this.pageSize,key:this.filterText,startTime:t,endTime:e,...this.gourmetQueryDto},l=await this.$axios.post("/gourmet/query",a),{data:s}=l;this.tableData=s.data,this.totalItems=s.total}catch(t){this.$message.error("查询美食做法信息异常:",t),console.error("查询美食做法信息异常:",t)}},add(){this.dialogGourmetOperaion=!0},handleFilter(){this.currentPage=1,this.fetchFreshData()},handleFilterClear(){this.filterText="",this.handleFilter()},handleSizeChange(t){this.pageSize=t,this.currentPage=1,this.fetchFreshData()},handleCurrentChange(t){this.currentPage=t,this.fetchFreshData()},handleEdit(t){this.dialogGourmetOperaion=!0,this.isOperation=!0,this.data={...t}},handleDelete(t){this.delectedRows.push(t),this.batchDelete()}}},r=i,o=a("2877"),n=Object(o["a"])(r,l,s,!1,null,"821e6086",null);e["default"]=n.exports}}]);
//# sourceMappingURL=chunk-2d0d0833.f28a8758.js.map