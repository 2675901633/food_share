(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-166207d8"],{"19e3":function(t,e,a){"use strict";a("a191")},"2a9c":function(t,e,a){},3631:function(t,e,a){"use strict";a("2a9c")},"417e":function(t,e,a){"use strict";a("fc46")},a191:function(t,e,a){},c3dc:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-row",{staticStyle:{"background-color":"rgb(255,255,255)",padding:"20px"}},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"info"},[a("div",[a("img",{attrs:{src:t.info.userAvatar,alt:""}})]),a("div",[a("div",{staticClass:"title"},[t._v(t._s(t.info.userName))]),a("div",{staticClass:"point-info"},[a("span",[a("span",{staticClass:"count"},[t._v(t._s(t.info.viewCount))]),t._v("阅读量 ")]),a("span",[a("span",{staticClass:"count"},[t._v(" "+t._s(t.info.upvoteCount)+" ")]),t._v(" 获赞量 ")]),a("span",[a("span",{staticClass:"count"},[t._v(t._s(t.info.saveCount))]),t._v(" 收藏量 ")])])])]),a("div",{staticStyle:{"margin-inline":"20px"}},[a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"美食帖子",name:"first"}},t._l(t.gourmetList,(function(e,s){return a("div",{key:s,staticClass:"item-gourmet",staticStyle:{display:"flex","justify-content":"left"}},[a("div",{staticClass:"left"},[a("img",{attrs:{src:e.cover}})]),a("div",{staticClass:"right"},[a("div",{staticClass:"info"},[a("img",{staticStyle:{width:"20px",height:"20px","border-radius":"10px"},attrs:{src:e.userAvatar,alt:""}}),a("span",[t._v(t._s(e.userName))])]),a("div",{staticClass:"title",on:{click:function(a){return t.readGourmet(e)}}},[t._v(" "+t._s(e.title)+" ")]),a("div",{staticClass:"detail"},[t._v(" "+t._s(e.detail)+" ")]),a("div",{staticClass:"detail"},[a("span",[t._v(" "+t._s(e.createTime)+" ")]),a("span",[a("i",{staticClass:"el-icon-discount",staticStyle:{"margin-right":"4px"}}),t._v("("+t._s(e.upvoteCount)+") ")]),a("span",[a("i",{staticClass:"el-icon-view",staticStyle:{"margin-right":"4px"}}),t._v("("+t._s(e.viewCount)+") ")]),a("span",[a("i",{staticClass:"el-icon-star-off",staticStyle:{"margin-right":"4px"}}),t._v("("+t._s(e.saveCount)+") ")]),a("span",{staticStyle:{color:"rgb(0, 112, 193)"},on:{click:function(a){return t.share(e)}}},[t._v(" 分享 ")]),a("span",{staticStyle:{color:"rgb(0, 112, 193)"},on:{click:function(a){return t.edit(e)}}},[t._v(" 修改 ")]),a("span",{staticStyle:{color:"rgb(143, 94, 38)"},on:{click:function(a){return t.del(e)}}},[t._v(" 删除 ")])])])])})),0)],1)],1)]),a("el-dialog",{attrs:{visible:t.dialogShareOperaion,width:"20%"},on:{"update:visible":function(e){t.dialogShareOperaion=e}}},[a("div",{staticStyle:{padding:"16px 20px"}},[""===t.url?a("p",{staticStyle:{"text-align":"center"}},[t._v("内容分享")]):t._e(),""!==t.url?a("div",[a("el-result",{attrs:{icon:"success",title:"分享成功",subTitle:""}},[a("template",{slot:"extra"},[a("span",[t._v(" "+t._s(t.url)+" ")])])],2)],1):a("div",[a("div",[a("p",[t._v("*有效期")]),a("el-radio-group",{attrs:{size:"mini"},model:{value:t.contentNet.validDay,callback:function(e){t.$set(t.contentNet,"validDay",e)},expression:"contentNet.validDay"}},[a("el-radio-button",{attrs:{label:"3天"}}),a("el-radio-button",{attrs:{label:"7天"}}),a("el-radio-button",{attrs:{label:"30天"}}),a("el-radio-button",{attrs:{label:"长期有效"}})],1)],1),a("div",[a("p",[t._v("*是否启用密码认证")]),a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.contentNet.passwordAuth,callback:function(e){t.$set(t.contentNet,"passwordAuth",e)},expression:"contentNet.passwordAuth"}})],1),t.contentNet.passwordAuth?a("div",[a("p",[t._v("*访问密码")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.contentNet.accessPassword,expression:"contentNet.accessPassword"}],staticClass:"dialog-input",attrs:{type:"password",placeholder:"密码"},domProps:{value:t.contentNet.accessPassword},on:{input:function(e){e.target.composing||t.$set(t.contentNet,"accessPassword",e.target.value)}}})]):t._e()])]),a("span",{staticClass:"dialog-footer",staticStyle:{"margin-top":"10px"},attrs:{slot:"footer"},slot:"footer"},[a("span",{staticClass:"channel-button",on:{click:function(e){return t.cannel()}}},[t._v(" 取消操作 ")]),""===t.url?a("div",[a("span",{staticClass:"edit-button",on:{click:function(e){return t.addOperation()}}},[t._v(" 确定分享 ")])]):t._e()])])],1),a("el-row",{staticStyle:{"background-color":"rgb(255,255,255)",padding:"20px","margin-top":"20px"}},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"feature-cards"},[a("el-card",{staticClass:"feature-card",attrs:{shadow:"hover"},nativeOn:{click:function(e){return t.goToTrending.apply(null,arguments)}}},[a("div",{staticClass:"feature-icon"},[a("i",{staticClass:"el-icon-data-line"})]),a("div",{staticClass:"feature-content"},[a("h3",[t._v("热门排行榜")]),a("p",[t._v("查看实时热门美食排行榜和UV统计数据")])])]),a("el-card",{staticClass:"feature-card",attrs:{shadow:"hover"},nativeOn:{click:function(e){return t.route("/hot")}}},[a("div",{staticClass:"feature-icon"},[a("i",{staticClass:"el-icon-data-analysis"})]),a("div",{staticClass:"feature-content"},[a("h3",[t._v("流量分析")]),a("p",[t._v("查看美食互动数据和流量统计")])])])],1)])],1),a("el-row",{staticStyle:{"background-color":"rgb(255,255,255)",padding:"20px"}},[a("div",{staticStyle:{padding:"30px","margin-top":"30px"}},[a("Hot")],1)])],1)},i=[],n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",{staticStyle:{"background-color":"#FFFFFF",padding:"5px 0","border-radius":"5px"}},[a("el-row",{},[a("el-row",{staticStyle:{display:"flex","justify-content":"left",gap:"6px"}},[a("el-date-picker",{staticStyle:{width:"216px"},attrs:{size:"small",type:"daterange","range-separator":"至","start-placeholder":"分享开始","end-placeholder":"分享结束"},on:{change:t.fetchFreshData},model:{value:t.searchTime,callback:function(e){t.searchTime=e},expression:"searchTime"}}),a("el-input",{staticStyle:{width:"416px"},attrs:{size:"small",placeholder:"访问码",clearable:""},on:{clear:t.handleFilterClear},model:{value:t.contentNetQueryDto.accessCode,callback:function(e){t.$set(t.contentNetQueryDto,"accessCode",e)},expression:"contentNetQueryDto.accessCode"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.handleFilter},slot:"append"})],1)],1)],1),a("el-row",{staticStyle:{"border-top":"1px solid rgb(245,245,245)"}},[a("el-table",{attrs:{stripe:!0,data:t.tableData}},[a("el-table-column",{attrs:{prop:"gourmetTitle",label:"分享内容"}}),a("el-table-column",{attrs:{prop:"gourmetId",sortable:!0,label:"内容ID",width:"98"}}),a("el-table-column",{attrs:{prop:"accessCode",label:"访问码",width:"118"}}),a("el-table-column",{attrs:{prop:"accessPassword",label:"访问密码",width:"118"}}),a("el-table-column",{attrs:{prop:"url",label:"链接",width:"158"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s("http://localhost:21091/shareDetail?accessCode="+e.row.accessCode))])]}}])}),a("el-table-column",{attrs:{prop:"passwordAuth",label:"认证状态",width:"118"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.passwordAuth?"密码":"非认证"))])]}}])}),a("el-table-column",{attrs:{prop:"validDay",sortable:!0,label:"有效期",width:"98"}}),a("el-table-column",{attrs:{prop:"createTime",label:"分享时间",sortable:!0,width:"168"}}),a("el-table-column",{attrs:{label:"操作",width:"110"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"text-button",on:{click:function(a){return t.handleEdit(e.row)}}},[t._v("编辑")]),a("span",{staticClass:"text-button",on:{click:function(a){return t.handleDelete(e.row)}}},[t._v("删除")])]}}])})],1),a("el-pagination",{staticStyle:{margin:"10px 0",float:"right"},attrs:{"current-page":t.currentPage,"page-sizes":[20,50],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.totalItems},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),a("el-dialog",{attrs:{visible:t.dialogShareOperaion,width:"20%"},on:{"update:visible":function(e){t.dialogShareOperaion=e}}},[a("div",{staticStyle:{padding:"16px 20px"}},[a("p",{staticStyle:{"text-align":"center"}},[t._v("分享修改")]),a("div",[a("div",[a("p",[t._v("*有效期")]),a("el-radio-group",{attrs:{size:"mini"},model:{value:t.contentNet.validDay,callback:function(e){t.$set(t.contentNet,"validDay",e)},expression:"contentNet.validDay"}},[a("el-radio-button",{attrs:{label:"3天"}}),a("el-radio-button",{attrs:{label:"7天"}}),a("el-radio-button",{attrs:{label:"30天"}}),a("el-radio-button",{attrs:{label:"长期有效"}})],1)],1),a("div",[a("p",[t._v("*是否启用密码认证")]),a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:t.contentNet.passwordAuth,callback:function(e){t.$set(t.contentNet,"passwordAuth",e)},expression:"contentNet.passwordAuth"}})],1),t.contentNet.passwordAuth?a("div",[a("p",[t._v("*访问密码")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.contentNet.accessPassword,expression:"contentNet.accessPassword"}],staticClass:"dialog-input",attrs:{type:"password",placeholder:"密码"},domProps:{value:t.contentNet.accessPassword},on:{input:function(e){e.target.composing||t.$set(t.contentNet,"accessPassword",e.target.value)}}})]):t._e()])]),a("span",{staticClass:"dialog-footer",staticStyle:{"margin-top":"10px"},attrs:{slot:"footer"},slot:"footer"},[a("span",{staticClass:"channel-button",on:{click:function(e){return t.cannel()}}},[t._v(" 取消操作 ")]),a("span",{staticClass:"edit-button",on:{click:function(e){return t.updateOperation()}}},[t._v(" 确定修改 ")])])])],1)},o=[],r={data(){return{data:{},filterText:"",currentPage:1,pageSize:20,totalItems:0,tableData:[],delectedRows:[],searchTime:[],contentNetQueryDto:{},contentNet:{},dialogShareOperaion:!1}},created(){this.fetchFreshData()},methods:{updateOperation(){const t=[this.contentNet.validDay],e=t.map(t=>{const e=t.match(/\d+/g);return e||[]});this.contentNet.passwordAuth&&(this.contentNet.accessPassword=this.$md5(this.contentNet.accessPassword));const a={id:this.contentNet.id,validDay:0===e[0].length?-1:e[0][0],passwordAuth:this.contentNet.passwordAuth,accessPassword:this.contentNet.accessPassword};this.$axios.put("/contentNet/update",a).then(t=>{const{data:e}=t;200===e.code&&(this.$notify({duration:1e3,title:"分享操作",message:"修改成功",type:"success"}),this.cannel(),this.fetchFreshData())}).catch(t=>{console.log("修改内容分享异常",t)})},cannel(){this.dialogShareOperaion=!1,this.contentNet()},async batchDelete(){if(!this.delectedRows.length)return void this.$message("未选中任何数据");const t=await this.$swalConfirm({title:"删除内容分享数据",text:"删除后不可恢复，是否继续？",icon:"warning"});if(t)try{let t=this.delectedRows.map(t=>t.id);const e=await this.$axios.post("/contentNet/batchDelete",t);if(200===e.data.code)return this.$notify({duration:1e3,title:"信息删除",message:"删除成功",type:"success"}),void this.fetchFreshData()}catch(e){this.$message.error("内容分享信息删除异常：",e),console.error("内容分享信息删除异常：",e)}},async fetchFreshData(){try{this.tableData=[];let t=null,e=null;if(null!=this.searchTime&&2===this.searchTime.length){const[a,s]=await Promise.all(this.searchTime.map(t=>t.toISOString()));t=a.split("T")[0]+"T00:00:00",e=s.split("T")[0]+"T23:59:59"}const a={current:this.currentPage,size:this.pageSize,key:this.filterText,startTime:t,endTime:e,...this.contentNetQueryDto},s=await this.$axios.post("/contentNet/queryUser",a),{data:i}=s;this.tableData=i.data,this.totalItems=i.total}catch(t){this.$message.error("查询内容分享信息异常:",t),console.error("查询内容分享信息异常:",t)}},handleFilter(){this.currentPage=1,this.fetchFreshData()},handleFilterClear(){this.filterText="",this.handleFilter()},handleSizeChange(t){this.pageSize=t,this.currentPage=1,this.fetchFreshData()},handleCurrentChange(t){this.currentPage=t,this.fetchFreshData()},handleEdit(t){this.contentNet=t,-1===t.validDay?this.contentNet.validDay="长期有效":this.contentNet.validDay=t.validDay+"天",this.dialogShareOperaion=!0},handleDelete(t){this.delectedRows.push(t),this.batchDelete()}}},c=r,l=a("2877"),d=Object(l["a"])(c,n,o,!1,null,"24fe2752",null),h=d.exports,u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"item-type"},t._l(t.interactionTypes,(function(e,s){return a("span",{key:s,style:{backgroundColor:t.item.id===e.id?"rgb(91, 142, 248)":"",color:t.item.id===e.id?"rgb(245,245,245)":""},on:{click:function(a){return t.typeSelected(e)}}},[t._v(t._s(e.name))])})),0),a("LineChart",{attrs:{tag:t.tag,height:"500px",values:t.values,date:t.dates},on:{"on-selected":t.onSelected}})],1)},p=[],g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"line-main"},[a("div",[a("span",{staticClass:"tag"},[t._v(t._s(t.tag))]),a("span",{staticClass:"time-show"},[a("span",{staticClass:"top-bar",staticStyle:{"font-size":"12px"}},[t._v("时间选择")]),a("el-select",{staticStyle:{width:"90px"},attrs:{size:"mini",placeholder:"期限"},model:{value:t.selectedValue,callback:function(e){t.selectedValue=e},expression:"selectedValue"}},t._l(t.options,(function(t){return a("el-option",{key:t.num,attrs:{label:t.name,value:t.num}})})),1)],1)]),a("div",{ref:"chart",style:{width:"100%",height:t.height}})])},v=[],f=a("313e"),m={name:"DialogLine",props:{tag:{type:String,default:"折线图"},values:{type:Array,required:!0},date:{type:Array,required:!0},height:{type:String,default:"220px"}},watch:{selectedValue(t,e){this.$emit("on-selected",t)},values(t,e){this.initChart()}},data(){return{chart:null,options:[{num:7,name:"7天内"},{num:30,name:"30天内"},{num:60,name:"60天内"}],selectedValue:""}},methods:{initChart(){this.chart=f["init"](this.$refs.chart);let t={grid:{left:30,right:10,top:50,borderWidth:0},title:{text:"",color:"#ffffff"},tooltip:{trigger:"axis",formatter:"{b}{c}"},legend:{data:[""]},xAxis:{data:this.date,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"rgb(102, 102, 102)",fontSize:"12"}},yAxis:{axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"rgb(102, 102, 102)",fontSize:"12"}},series:[{name:"",type:"line",smooth:!0,data:this.values,areaStyle:{color:"rgba(144, 191, 237, 0.3)"},lineStyle:{color:"#5B8FF9"},itemStyle:{color:"#5B8FF9",borderColor:"#5B8FF9",borderWidth:2},label:{show:!0,position:"top",color:"rgb(102, 102, 102)"}}]};this.chart.setOption(t)}},beforeDestroy(){this.chart&&this.chart.dispose()}},y=m,b=(a("3631"),Object(l["a"])(y,g,v,!1,null,"63eea6f8",null)),w=b.exports,x={components:{LineChart:w},name:"Hot",data(){return{interactionQueryDto:{day:365},values:[],dates:[],interactionTypes:[],item:{},tag:"流量状况"}},created(){this.fetchInteractionTypes()},methods:{changeTag(t){1===t.id?this.tag="点赞量":2===t.id?this.tag="收藏人数":3===t.id?this.tag="阅读量":4===t.id&&(this.tag="评分人数")},typeSelected(t){this.changeTag(t),this.item=t,this.interactionQueryDto.type=t.id,this.fetchHotData()},fetchInteractionTypes(){this.$axios.get("/interaction/types").then(t=>{const{data:e}=t;200===e.code&&(this.interactionTypes=e.data,this.typeSelected(this.interactionTypes[0]))}).catch(t=>{console.log("查询互动类型异常",t)})},onSelected(t){this.interactionQueryDto.day=t,this.fetchHotData()},fetchHotData(){this.$axios.post("/interaction/daysQuery",this.interactionQueryDto).then(t=>{const{data:e}=t;if(200===e.code){const t=e.data;this.values=t.map(t=>t.count),this.dates=t.map(t=>t.name)}}).catch(t=>{console.log("查询流量状况数据异常",t)})}}},_=x,C=(a("19e3"),Object(l["a"])(_,u,p,!1,null,"40cd1c97",null)),S=C.exports,N={components:{MyContentNetManage:h,Hot:S},name:"Service",data(){return{contentNet:{passwordAuth:!1},gourmet:{},info:{},activeName:"first",gourmetList:[],dialogShareOperaion:!1,url:""}},created(){this.fetchMyslefGourmet(),this.fetchCenter()},methods:{goToTrending(){this.$router.push("/trending")},route(t){this.$router.push(t)},addOperation(){const t=[this.contentNet.validDay],e=t.map(t=>{const e=t.match(/\d+/g);return e||[]});this.contentNet.passwordAuth&&(this.contentNet.accessPassword=this.$md5(this.contentNet.accessPassword));const a={gourmetId:this.gourmet.id,validDay:0===e[0].length?-1:e[0][0],passwordAuth:this.contentNet.passwordAuth,accessPassword:this.contentNet.accessPassword};this.$axios.post("/contentNet/save",a).then(t=>{const{data:e}=t;200===e.code&&(this.$notify({duration:1e3,title:"分享操作",message:"分享成功",type:"success"}),this.url=e.msg)}).catch(t=>{console.log("查询美食做法数据异常",t)})},cannel(){this.dialogShareOperaion=!1,this.url="",this.contentNet={}},shareOperation(){},edit(t){sessionStorage.setItem("gourmetId",t.id),this.$router.push("/editGourmet")},share(t){this.gourmet=t,this.dialogShareOperaion=!0},async del(t){const e=await this.$swalConfirm({title:"删除美食做法数据",text:"删除后不可恢复，是否继续？",icon:"warning"});if(e)try{let e=[t.id];const a=await this.$axios.post("/gourmet/batchDelete",e);if(200===a.data.code)return this.$notify({duration:1e3,title:"信息删除",message:"删除成功",type:"success"}),void this.fetchMyslefGourmet()}catch(a){this.$notify.error({duration:1e3,title:"删除错误",message:a}),console.error("美食做法信息删除异常：",a)}},handleClick(t,e){console.log(t,e)},readGourmet(t){sessionStorage.setItem("gourmetId",t.id),this.$router.push("/gourmetDetail")},fetchMyslefGourmet(){this.$axios.get("/gourmet/queryUser").then(t=>{const{data:e}=t;200===e.code&&(this.gourmetList=e.data)}).catch(t=>{console.log("查询美食做法数据异常",t)})},fetchCenter(){this.$axios.get("/user/center").then(t=>{const{data:e}=t;200===e.code&&(this.info=e.data)}).catch(t=>{console.log("查询个人中心数据异常",t)})}}},D=N,k=(a("417e"),Object(l["a"])(D,s,i,!1,null,"3d0edfff",null));e["default"]=k.exports},fc46:function(t,e,a){}}]);
//# sourceMappingURL=chunk-166207d8.3b376bc0.js.map