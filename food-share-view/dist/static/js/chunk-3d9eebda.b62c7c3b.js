(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3d9eebda"],{1639:function(t,e,a){"use strict";a("8801")},"345c":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"my-orders-container"},[a("div",{staticClass:"page-header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/flashSale"}}},[t._v("限时秒杀")]),a("el-breadcrumb-item",[t._v("我的秒杀订单")])],1),a("h2",[t._v("我的秒杀订单")])],1),a("div",{staticClass:"orders-filter"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.loadData}},[t._v("刷新")]),a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(e){return t.$router.push("/flashSale")}}},[t._v("继续秒杀")])],1),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"orders-content"},[0===t.orders.length?a("div",{staticClass:"empty-data"},[a("i",{staticClass:"el-icon-tickets"}),a("p",[t._v("暂无订单数据")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$router.push("/flashSale")}}},[t._v("去秒杀")])],1):a("div",{staticClass:"orders-list"},t._l(t.orders,(function(e){return a("el-card",{key:e.id,staticClass:"order-card",attrs:{shadow:"hover"}},[a("div",{staticClass:"order-header"},[a("div",{staticClass:"order-id"},[a("span",{staticClass:"label"},[t._v("订单号:")]),a("span",{staticClass:"value"},[t._v(t._s(e.orderId))])]),a("div",{staticClass:"order-status",class:t.getOrderStatusClass(e.status)},[t._v(" "+t._s(t.getOrderStatusText(e.status))+" ")])]),a("div",{staticClass:"order-info"},[a("div",{staticClass:"order-item-info"},[a("div",{staticClass:"item-id"},[a("span",{staticClass:"label"},[t._v("商品ID:")]),a("span",{staticClass:"value"},[t._v(t._s(e.itemId))])]),a("div",{staticClass:"item-price"},[a("span",{staticClass:"label"},[t._v("价格:")]),a("span",{staticClass:"price-value"},[t._v("¥"+t._s(e.price))])])]),a("div",{staticClass:"order-time-info"},[a("div",{staticClass:"order-time"},[a("i",{staticClass:"el-icon-time"}),a("span",[t._v("下单时间: "+t._s(t.formatDateTime(e.orderTime)))])]),a("div",{staticClass:"order-actions"},[a("el-button",{attrs:{type:"primary",size:"small",disabled:1!==e.status},on:{click:function(a){return t.handlePayOrder(e)}}},[t._v(" 支付订单 ")]),a("el-button",{attrs:{type:"danger",size:"small",plain:"",disabled:1!==e.status},on:{click:function(a){return t.handleCancelOrder(e)}}},[t._v(" 取消订单 ")]),a("el-button",{attrs:{type:"info",size:"small"},on:{click:function(a){return t.viewItemDetail(e.itemId)}}},[t._v(" 查看商品 ")])],1)])])])})),1),t.orders.length>0?a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":t.pageSize,layout:"total, prev, pager, next",total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1):t._e()]),a("el-dialog",{attrs:{title:t.dialogTitle,visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("span",[t._v(t._s(t.dialogMessage))]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",loading:t.actionLoading},on:{click:t.confirmDialog}},[t._v("确定")])],1)])],1)},s=[],i=a("35ed"),n={name:"MyFlashSaleOrders",data(){return{loading:!1,actionLoading:!1,orders:[],currentPage:1,pageSize:5,total:0,dialogVisible:!1,dialogTitle:"",dialogMessage:"",currentOrder:null,actionType:""}},created(){this.loadData()},methods:{loadData(){this.loading=!0,Object(i["j"])().then(t=>{if(t.data&&200===t.data.code){this.orders=t.data.data||[],this.total=this.orders.length;const e=(this.currentPage-1)*this.pageSize,a=e+this.pageSize;this.orders=this.orders.slice(e,a)}else this.$message.error(t.data.msg||"获取订单失败"),this.orders=[],this.total=0}).catch(t=>{console.error(t),this.$message.error("获取订单失败"),this.orders=[],this.total=0}).finally(()=>{this.loading=!1})},handleCurrentChange(){this.loadData()},handlePayOrder(t){this.currentOrder=t,this.dialogTitle="支付确认",this.dialogMessage=`确定要支付订单 ${t.orderId} 吗？`,this.actionType="pay",this.dialogVisible=!0},handleCancelOrder(t){this.currentOrder=t,this.dialogTitle="取消确认",this.dialogMessage=`确定要取消订单 ${t.orderId} 吗？`,this.actionType="cancel",this.dialogVisible=!0},confirmDialog(){this.currentOrder?(this.actionLoading=!0,"pay"===this.actionType?this.payOrder():"cancel"===this.actionType&&this.cancelOrder()):this.dialogVisible=!1},payOrder(){Object(i["h"])(this.currentOrder.orderId).then(t=>{t.data&&200===t.data.code?(this.$message.success("订单支付成功"),this.loadData(),setTimeout(()=>{this.$notify({title:"支付成功",message:`订单${this.currentOrder.orderId}支付成功，感谢您的购买！`,type:"success",duration:3e3})},500)):this.$message.error(t.data.msg||"订单支付失败")}).catch(t=>{console.error(t),this.$message.error("订单支付失败")}).finally(()=>{this.actionLoading=!1,this.dialogVisible=!1})},cancelOrder(){Object(i["a"])(this.currentOrder.orderId).then(t=>{t.data&&200===t.data.code?(this.$message.success("订单取消成功"),this.loadData()):this.$message.error(t.data.msg||"订单取消失败")}).catch(t=>{console.error(t),this.$message.error("订单取消失败")}).finally(()=>{this.actionLoading=!1,this.dialogVisible=!1})},viewItemDetail(t){this.$router.push({path:"/flashSaleDetail",query:{id:t}})},getOrderStatusText(t){return 1===t?"待支付":2===t?"已支付":3===t?"已取消":"未知状态"},getOrderStatusClass(t){return 1===t?"pending":2===t?"paid":3===t?"canceled":""},formatDateTime(t){if(!t)return"";const e=new Date(t);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`}}},l=n,o=(a("1639"),a("2877")),d=Object(o["a"])(l,r,s,!1,null,"5a394927",null);e["default"]=d.exports},"35ed":function(t,e,a){"use strict";a.d(e,"g",(function(){return s})),a.d(e,"f",(function(){return i})),a.d(e,"d",(function(){return n})),a.d(e,"j",(function(){return l})),a.d(e,"a",(function(){return o})),a.d(e,"b",(function(){return d})),a.d(e,"l",(function(){return c})),a.d(e,"c",(function(){return u})),a.d(e,"i",(function(){return h})),a.d(e,"k",(function(){return g})),a.d(e,"e",(function(){return p})),a.d(e,"h",(function(){return f}));var r=a("b775");function s(t){return Object(r["a"])({url:"/flashSale/list",method:"post",data:t})}function i(t){return Object(r["a"])({url:"/flashSale/detail/"+t,method:"get"})}function n(t){return Object(r["a"])({url:"/flashSale/doFlashSale/"+t,method:"post"})}function l(){return Object(r["a"])({url:"/flashSale/myOrders",method:"get"})}function o(t){return Object(r["a"])({url:"/flashSale/cancelOrder/"+t,method:"post"})}function d(t){return Object(r["a"])({url:"/flashSale/admin/create",method:"post",data:t})}function c(t){return Object(r["a"])({url:"/flashSale/admin/update",method:"post",data:t})}function u(t){return Object(r["a"])({url:"/flashSale/admin/delete/"+t,method:"post"})}function h(){return Object(r["a"])({url:"/flashSale/admin/preload",method:"post"})}function g(){return Object(r["a"])({url:"/flashSale/admin/refresh",method:"post"})}function p(t){return Object(r["a"])({url:"/flashSale/orders",method:"post",data:t})}function f(t){return Object(r["a"])({url:"/flashSale/payOrder/"+t,method:"post"})}},8801:function(t,e,a){}}]);
//# sourceMappingURL=chunk-3d9eebda.b62c7c3b.js.map